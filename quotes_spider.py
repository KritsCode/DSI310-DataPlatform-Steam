import scrapy

#Scripts\activate เพื่อเข้าไปใน environment 
#ก่อนใช้ ให้เข้าไปใน tutorial ก่อน โดยการ cd tutorial
#ใช้ scrapy crawl quotes -o LMAOXD.csv โดย LMAOXD คือชื่อไฟล์ และ .csv คือนามสกุลที่อยากได้ สามารถเปลี่ยนเป็น json ได้
#ใช้ scrapy shell https://store.steampowered.com/app/551170/Onmyoji/ เพื่อ test
#Tutorial Vid : https://youtu.be/ALizgnSFTwQ

class QuotesSpider(scrapy.Spider):
    name = "quotes"
    start_urls = [
        'https://store.steampowered.com/app/551170/Onmyoji/',
        'https://store.steampowered.com/app/1997040/MARVEL_SNAP/',
        'https://store.steampowered.com/app/1811260/EA_SPORTS_FIFA_23/',
        'https://store.steampowered.com/app/1712830/Baldis_Basics_Classic_Remastered/',
        'https://store.steampowered.com/app/493520/GTFO/',
        'https://store.steampowered.com/app/594650/Hunt_Showdown/',
        'https://store.steampowered.com/app/460930/Tom_Clancys_Ghost_Recon_Wildlands/',
        'https://store.steampowered.com/app/1144200/Ready_or_Not/',
        'https://store.steampowered.com/app/730/CounterStrike_Global_Offensive/',
        'https://store.steampowered.com/app/1172470/Apex_Legends/',
        'https://store.steampowered.com/app/440/Team_Fortress_2/',
        'https://store.steampowered.com/app/444090/Paladins/',
        'https://store.steampowered.com/app/359550/Tom_Clancys_Rainbow_Six_Siege/',
        'https://store.steampowered.com/app/1816670/GUNDAM_EVOLUTION/',
        'https://store.steampowered.com/app/261550/Mount__Blade_II_Bannerlord/',
        'https://store.steampowered.com/app/582660/Black_Desert/',
        'https://store.steampowered.com/app/1063730/New_World/',
        'https://store.steampowered.com/app/1172620/Sea_of_Thieves/',
        'https://store.steampowered.com/app/1222680/Need_for_Speed_Heat/',
        'https://store.steampowered.com/app/1551360/Forza_Horizon_5/',
        'https://store.steampowered.com/app/646910/The_Crew_2/',
        'https://store.steampowered.com/app/1687950/Persona_5_Royal/',
        'https://store.steampowered.com/app/1113000/Persona_4_Golden/',
        'https://store.steampowered.com/app/397540/Borderlands_3/',
        'https://store.steampowered.com/app/1217060/Gunfire_Reborn/',
        'https://store.steampowered.com/app/632360/Risk_of_Rain_2/'
        'https://store.steampowered.com/app/1172470/Apex_Legends/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/570/Dota_2/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1938090/Call_of_Duty_Modern_Warfare_II/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1091500/Cyberpunk_2077/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1174180/Red_Dead_Redemption_2/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1811260/EA_SPORTS_FIFA_23/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/578080/PUBG_BATTLEGROUNDS/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1196590/Resident_Evil_Village/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1549250/UNDECEMBER/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1222670/The_Sims_4/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/271590/Grand_Theft_Auto_V/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/381210/Dead_by_Daylight/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1904540/Football_Manager_2023/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/730/CounterStrike_Global_Offensive/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/236390/War_Thunder/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1687950/Persona_5_Royal/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/242760/The_Forest/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/582660/Black_Desert/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/108600/Project_Zomboid/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/252490/Rust/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/529340/Victoria_3/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/739630/Phasmophobia/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/230410/Warframe/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1158160/Coral_Island/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/292030/The_Witcher_3_Wild_Hunt/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/239140/Dying_Light/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1313140/Cult_of_the_Lamb/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1203220/NARAKA_BLADEPOINT/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1245620/ELDEN_RING/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1919590/NBA_2K23/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/883710/Resident_Evil_2/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1731080/Resident_Evil_Village__Winters_Expansion/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/294100/RimWorld/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/261550/Mount__Blade_II_Bannerlord/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/952060/Resident_Evil_3/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/594650/Hunt_Showdown/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1259420/Days_Gone/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/359550/Tom_Clancys_Rainbow_Six_Siege/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1172620/Sea_of_Thieves/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1085660/Destiny_2/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1604030/V_Rising/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/322330/Dont_Starve_Together/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1551360/Forza_Horizon_5/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/815370/Green_Hell/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/413150/Stardew_Valley/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/1826140/RimWorld__Biotech/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/251570/7_Days_to_Die/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/107410/Arma_3/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/431960/Wallpaper_Engine/?snr=1_7_7_230_150_1',
        'https://store.steampowered.com/app/281990/Stellaris/?snr=1_7_7_230_150_1'
        'https://store.steampowered.com/app/699130/World_War_Z_Aftermath/',
        'https://store.steampowered.com/app/550/Left_4_Dead_2/',
        'https://store.steampowered.com/app/493520/GTFO/',
        'https://store.steampowered.com/app/924970/Back_4_Blood/',
        'https://store.steampowered.com/app/493520/GTFO/',
        'https://store.steampowered.com/app/730/CounterStrike_Global_Offensive/',
        'https://store.steampowered.com/app/218620/PAYDAY_2/',
        'https://store.steampowered.com/app/578080/PUBG_BATTLEGROUNDS/',
        'https://store.steampowered.com/app/1190340/SUPER_PEOPLE/',
        'https://store.steampowered.com/app/393380/Squad/',
        'https://store.steampowered.com/app/16900/GROUND_BRANCH/',
        'https://store.steampowered.com/app/359550/Tom_Clancys_Rainbow_Six_Siege/',
        'https://store.steampowered.com/app/578080/PUBG_BATTLEGROUNDS/',
        'https://store.steampowered.com/app/1172470/Apex_Legends/',
        'https://store.steampowered.com/app/440/Team_Fortress_2/',
        'https://store.steampowered.com/app/107410/Arma_3/',
        'https://store.steampowered.com/app/1938090/Call_of_Duty_Modern_Warfare_II/',
        'https://store.steampowered.com/app/393380/Squad/',
        'https://store.steampowered.com/app/581320/Insurgency_Sandstorm/',
        'https://store.steampowered.com/app/594650/Hunt_Showdown/',
        'https://store.steampowered.com/app/232090/Killing_Floor_2/',
        'https://store.steampowered.com/app/674020/World_War_3/',
        'https://store.steampowered.com/app/686810/Hell_Let_Loose/',
        'https://store.steampowered.com/app/552990/World_of_Warships/',
        'https://store.steampowered.com/app/505460/Foxhole/',
        'https://store.steampowered.com/app/444200/World_of_Tanks_Blitz/',
        'https://store.steampowered.com/app/460930/Tom_Clancys_Ghost_Recon_Wildlands/',
        'https://store.steampowered.com/app/518790/theHunter_Call_of_the_Wild/',
        'https://store.steampowered.com/app/271590/Grand_Theft_Auto_V/',
        'https://store.steampowered.com/app/1172620/Sea_of_Thieves/',
        'https://store.steampowered.com/app/648800/Raft/',
        'https://store.steampowered.com/app/892970/Valheim/',
        'https://store.steampowered.com/app/242760/The_Forest/',
        'https://store.steampowered.com/app/322330/Dont_Starve_Together/',
        'https://store.steampowered.com/app/962130/Grounded/',
        'https://store.steampowered.com/app/105600/Terraria/',
        'https://store.steampowered.com/app/1174180/Red_Dead_Redemption_2/',
        'https://store.steampowered.com/app/1817070/Marvels_SpiderMan_Remastered/',
        'https://store.steampowered.com/app/242050/Assassins_Creed_IV_Black_Flag/',
        'https://store.steampowered.com/app/1174180/Red_Dead_Redemption_2/',
        'https://store.steampowered.com/app/287700/METAL_GEAR_SOLID_V_THE_PHANTOM_PAIN/',
        'https://store.steampowered.com/app/489830/The_Elder_Scrolls_V_Skyrim_Special_Edition/',
        'https://store.steampowered.com/app/740130/Tales_of_Arise/',
        'https://store.steampowered.com/app/292030/The_Witcher_3_Wild_Hunt/',
        'https://store.steampowered.com/app/377160/Fallout_4/',
        'https://store.steampowered.com/app/1222680/Need_for_Speed_Heat/',
        'https://store.steampowered.com/app/582010/Monster_Hunter_World/',
        'https://store.steampowered.com/app/815370/Green_Hell/',
        'https://store.steampowered.com/app/252490/Rust/',
        'https://store.steampowered.com/app/892970/Valheim/',
        'https://store.steampowered.com/app/440900/Conan_Exiles/',
        'https://store.steampowered.com/app/513710/SCUM/',
        'https://store.steampowered.com/app/1621070/DeadPoly/',
        'https://store.steampowered.com/app/1259420/Days_Gone/',
        'https://store.steampowered.com/app/914620/Mist_Survival/',
        'https://store.steampowered.com/app/251570/7_Days_to_Die/',
        'https://store.steampowered.com/app/346110/ARK_Survival_Evolved/',
        'https://store.steampowered.com/app/815370/Green_Hell/',
        'https://store.steampowered.com/app/1062520/Dinkum/',
        'https://store.steampowered.com/app/440900/Conan_Exiles/',
        'https://store.steampowered.com/app/346110/ARK_Survival_Evolved/',
        'https://store.steampowered.com/app/962130/Grounded/'
    ]

    def parse(self, response):
        for quote in response.css('div.page_content_ctn'):
            yield {
                'url' : response.request.url,
                'title': quote.css('.apphub_AppName::text').get(),
                'tag': quote.css('.app_tag::text').re('Hero Shooter|Battle Royale|Competitive|Roguelite|JRPG|Story Rich|Automobile Sim|Sports|Racing|Driving|Immersive Sim|Tactical|Management|Third Person|Simulation|Co-op|Local Multiplayer|Online Co-Op|PvE|Football|Soccer|PvP|Controller|Team-Based|Realistic|Local Co-Op|Multiplayer|Singleplayer|Anime|Strategy|Card Battler|Casual|PvP|Turn-Based Tactics|Card Game|Deckbuilding|Comic Book|Free to Play|Early Access|Superhero|Stylized|RPG|Free to Play|Turn-Based|Adventure|Fantasy|Stealth|Horror|Action|Parody|Retro|Funny|FPS|Shooter|Open World'),
                'price' : quote.css('.game_purchase_price.price::text').re('฿........')
            }
            
        # next_page = response.selector.css('div.block_responsive_horizontal_scroll a::attr(href)').get()
        # if next_page is not None:
        #     next_page = response.urljoin(next_page)
        #     yield scrapy.Request(next_page, callback=self.parse)

#//*[@id="recommended_block_content"]/a[1]
#//*[@id="recommended_block_content"]
# response.css('div').css('a').xpath(^A
#'price' : response.selector.xpath('//*[@id="game_area_purchase_section_add_to_cart_389471"]/div[2]/div/div[1]').getall()